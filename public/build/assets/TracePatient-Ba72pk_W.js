import{r as x,w as H,l as m,c as i,a as y,u as U,h as q,b as f,d as t,t as s,e as b,n as P,p as h,k as w,v as J,o as d,s as B,g as _,F as V,f as F}from"./app-F2ydNjPs.js";import{_ as K}from"./AppLayout-ZkD0rjf3.js";import{_ as L}from"./Pagination-CTx9YARu.js";import{_ as $}from"./Modal-r1CwFBUH.js";import{d as Q}from"./debounce-BjP9TRjn.js";/* empty css            */import"./_commonjsHelpers-_d1bhYXs.js";import"./debounce-D0G5qrda.js";const W={class:"min-h-screen transition-colors duration-200"},X={class:"dark:border-gray-700 shadow-sm bg-white dark:bg-gray-800"},Y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},Z={class:"flex items-center justify-between"},tt={class:"flex items-center space-x-4"},et={class:"text-sm bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200 px-3 py-1 rounded-full"},rt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-6"},st={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-6"},at={class:"border-b border-gray-200 dark:border-gray-700"},ot={class:"-mb-px flex space-x-8 px-6","aria-label":"Tabs"},dt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},nt={class:"bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 px-4 py-3 rounded-xl border border-red-200 dark:border-red-700"},it={class:"text-xl font-bold text-red-800 dark:text-red-300"},lt={class:"bg-gradient-to-r from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 px-4 py-3 rounded-xl border border-orange-200 dark:border-orange-700"},xt={class:"text-xl font-bold text-orange-800 dark:text-orange-300"},pt={class:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-900/20 dark:to-gray-800/20 px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700"},ct={class:"text-xl font-bold text-gray-800 dark:text-gray-300"},ut={class:"bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 px-4 py-3 rounded-xl border border-blue-200 dark:border-blue-700"},gt={class:"text-xl font-bold text-blue-800 dark:text-blue-300"},mt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},yt={class:"bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 px-4 py-3 rounded-xl border border-purple-200 dark:border-purple-700"},bt={class:"text-xl font-bold text-purple-800 dark:text-purple-300"},kt={class:"bg-gradient-to-r from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 px-4 py-3 rounded-xl border border-orange-200 dark:border-orange-700"},vt={class:"text-xl font-bold text-orange-800 dark:text-orange-300"},ft={class:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-900/20 dark:to-gray-800/20 px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-700"},ht={class:"text-xl font-bold text-gray-800 dark:text-gray-300"},wt={class:"bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 px-4 py-3 rounded-xl border border-green-200 dark:border-green-700"},_t={class:"text-xl font-bold text-green-800 dark:text-green-300"},Ct={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm"},Vt={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex flex-col md:flex-row md:items-center md:justify-between gap-4"},$t={class:"relative flex-1 max-w-md"},St={class:"flex items-center space-x-2 w-full md:w-auto"},jt=["disabled"],At=["disabled"],Tt={class:"overflow-x-auto"},Rt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Nt={class:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700"},Dt={class:"px-6 py-4 whitespace-nowrap"},Mt={class:"font-medium text-gray-900 dark:text-white"},zt={class:"text-sm text-gray-500 dark:text-gray-400"},Ht={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},Bt={class:"px-6 py-4 whitespace-nowrap"},Ft={key:0,class:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"},Lt={key:1,class:"text-gray-400 dark:text-gray-500 text-xs"},Et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Ot={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},It={class:"flex space-x-3"},Gt=["onClick"],Ut=["onClick"],qt={key:0},Jt={class:"overflow-x-auto"},Kt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Qt={class:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700"},Wt={class:"px-6 py-4 whitespace-nowrap"},Xt={class:"px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},Yt={class:"px-6 py-4 whitespace-nowrap"},Zt={class:"text-sm font-medium text-gray-900 dark:text-white"},te={class:"text-sm text-gray-500 dark:text-gray-400"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},re={class:"px-6 py-4 whitespace-nowrap"},se={class:"text-sm border py-1 px-2 rounded font-medium text-gray-900 dark:text-white dark:border-gray-600"},ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},oe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},de={class:"flex space-x-3"},ne=["onClick"],ie=["onClick"],le={key:0},xe={class:"p-6"},pe={class:"text-lg font-medium text-gray-900 dark:text-white"},ce={class:"mt-6 flex justify-end space-x-3"},ue={class:"p-6"},ge={class:"text-lg font-medium text-gray-900 dark:text-white"},me={class:"mt-6 flex justify-end space-x-3"},ye={class:"p-6"},be={class:"text-lg font-medium text-gray-900 dark:text-white"},ke={class:"mt-6 flex justify-end space-x-3"},Se={__name:"TracePatient",props:{patients:Object,prescriptions:Object,filters:Object,stats:Object},setup(a){const S=a,k=x(S.filters.search||""),n=x(S.filters.tab||"prescriptions");H(k,Q(o=>{m.get(route("admin.trace-patients"),{search:o,tab:n.value},{preserveState:!0,replace:!0})},300)),H(n,o=>{k.value="",m.get(route("admin.trace-patients"),{tab:o},{preserveState:!0})});const c=x(!1),u=x(!1),g=x(!1),C=x(""),l=x(""),p=x(null),j=o=>o?new Intl.NumberFormat("fr-FR").format(o):"0",A=o=>o?new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",T=(o,e)=>{p.value=o,l.value=e,C.value="restore",c.value=!0},R=(o,e)=>{p.value=o,l.value=e,C.value="delete",u.value=!0},N=o=>{l.value=o,C.value="empty",g.value=!0},E=()=>{if(!p.value)return;const o=l.value==="patient"?"admin.trace-patient.patients.restore":"admin.trace-patient.prescriptions.restore";m.post(route(o,p.value.id),{},{preserveScroll:!0,onSuccess:()=>c.value=!1})},O=()=>{if(!p.value)return;const o=l.value==="patient"?"admin.trace-patient.patients.force-delete":"admin.trace-patient.prescriptions.force-delete";m.delete(route(o,p.value.id),{preserveScroll:!0,onSuccess:()=>u.value=!1})},I=()=>{const o=l.value==="patient"?"admin.trace-patient.patients.empty":"admin.trace-patient.prescriptions.empty";m.delete(route(o),{preserveScroll:!0,onSuccess:()=>g.value=!1})};return(o,e)=>(d(),i(V,null,[y(U(q),{title:"Gestion de la Corbeille"}),y(K,null,{default:f(()=>[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[e[11]||(e[11]=t("div",{class:"flex items-center space-x-4"},[t("div",{class:"flex items-center"},[t("span",{class:"text-red-600 dark:text-red-400 text-xl mr-3"},"üóëÔ∏è"),t("h1",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Gestion de la Corbeille")])],-1)),t("div",tt,[t("div",et,s(a.stats.total)+" √©l√©ment(s) supprim√©(s) ",1)])])])]),t("div",rt,[t("div",st,[t("div",at,[t("nav",ot,[t("button",{onClick:e[0]||(e[0]=r=>n.value="prescriptions"),class:P([n.value==="prescriptions"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","py-4 px-1 border-b-2 font-medium text-sm flex items-center"])},[e[12]||(e[12]=t("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm0-9V12l-4 4-4-4V7.5h8z"})],-1)),h(" Prescriptions ("+s(a.stats.prescriptions.total)+") ",1)],2),t("button",{onClick:e[1]||(e[1]=r=>n.value="patients"),class:P([n.value==="patients"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300","py-4 px-1 border-b-2 font-medium text-sm flex items-center"])},[e[13]||(e[13]=t("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),t("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})],-1)),h(" Patients ("+s(a.stats.patients.total)+") ",1)],2)])])]),b(t("div",dt,[t("div",nt,[e[14]||(e[14]=t("p",{class:"text-xs font-medium text-red-600 dark:text-red-400 uppercase tracking-wide"},"Total patients",-1)),t("p",it,s(a.stats.patients.total),1)]),t("div",lt,[e[15]||(e[15]=t("p",{class:"text-xs font-medium text-orange-600 dark:text-orange-400 uppercase tracking-wide"},"R√©cents",-1)),t("p",xt,s(a.stats.patients.recent),1),e[16]||(e[16]=t("p",{class:"text-xs text-orange-700 dark:text-orange-400 mt-1"},"(7 derniers jours)",-1))]),t("div",pt,[e[17]||(e[17]=t("p",{class:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide"},"Anciens",-1)),t("p",ct,s(a.stats.patients.old),1),e[18]||(e[18]=t("p",{class:"text-xs text-gray-700 dark:text-gray-400 mt-1"},"(plus de 30 jours)",-1))]),t("div",ut,[e[19]||(e[19]=t("p",{class:"text-xs font-medium text-blue-600 dark:text-blue-400 uppercase tracking-wide"},"Avec prescriptions",-1)),t("p",gt,s(a.stats.patients.with_prescriptions),1),e[20]||(e[20]=t("p",{class:"text-xs text-blue-700 dark:text-blue-400 mt-1"},"(√† v√©rifier)",-1))])],512),[[w,n.value==="patients"]]),b(t("div",mt,[t("div",yt,[e[21]||(e[21]=t("p",{class:"text-xs font-medium text-purple-600 dark:text-purple-400 uppercase tracking-wide"},"Total prescriptions",-1)),t("p",bt,s(a.stats.prescriptions.total),1)]),t("div",kt,[e[22]||(e[22]=t("p",{class:"text-xs font-medium text-orange-600 dark:text-orange-400 uppercase tracking-wide"},"R√©centes",-1)),t("p",vt,s(a.stats.prescriptions.recent),1),e[23]||(e[23]=t("p",{class:"text-xs text-orange-700 dark:text-orange-400 mt-1"},"(7 derniers jours)",-1))]),t("div",ft,[e[24]||(e[24]=t("p",{class:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide"},"Anciennes",-1)),t("p",ht,s(a.stats.prescriptions.old),1),e[25]||(e[25]=t("p",{class:"text-xs text-gray-700 dark:text-gray-400 mt-1"},"(plus de 30 jours)",-1))]),t("div",wt,[e[26]||(e[26]=t("p",{class:"text-xs font-medium text-green-600 dark:text-green-400 uppercase tracking-wide"},"Valeur perdue",-1)),t("p",_t,s(j(a.stats.prescriptions.valeur_totale))+" Ar",1),e[27]||(e[27]=t("p",{class:"text-xs text-green-700 dark:text-green-400 mt-1"},"(montant total)",-1))])],512),[[w,n.value==="prescriptions"]]),t("div",Ct,[t("div",Vt,[t("div",$t,[b(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=r=>k.value=r),class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:"Rechercher..."},null,512),[[J,k.value]])]),t("div",St,[n.value==="patients"?(d(),i("button",{key:0,onClick:e[3]||(e[3]=r=>N("patient")),disabled:a.patients.data.length===0,class:"w-full md:w-auto px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center justify-center space-x-2 disabled:opacity-50"},[...e[28]||(e[28]=[t("span",null,"Vider corbeille patients",-1)])],8,jt)):(d(),i("button",{key:1,onClick:e[4]||(e[4]=r=>N("prescription")),disabled:a.prescriptions.data.length===0,class:"w-full md:w-auto px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center justify-center space-x-2 disabled:opacity-50"},[...e[29]||(e[29]=[t("span",null,"Vider corbeille prescriptions",-1)])],8,At))])]),b(t("div",Tt,[t("table",Rt,[e[31]||(e[31]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Patient"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Dossier"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Prescriptions li√©es"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Supprim√© le"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",Nt,[(d(!0),i(V,null,F(a.patients.data,r=>(d(),i("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Dt,[t("div",Mt,s(r.nom)+" "+s(r.prenom),1),t("div",zt,s(r.telephone),1)]),t("td",Ht,[t("span",Pt,s(r.numero_dossier),1)]),t("td",Bt,[r.prescriptions_count>0?(d(),i("span",Ft,s(r.prescriptions_count)+" prescription(s) ",1)):(d(),i("span",Lt,"Aucune"))]),t("td",Et,s(A(r.deleted_at)),1),t("td",Ot,[t("div",It,[t("button",{onClick:v=>T(r,"patient"),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300"},"Restaurer",8,Gt),t("button",{onClick:v=>R(r,"patient"),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},"Supprimer",8,Ut)])])]))),128)),a.patients.data.length===0?(d(),i("tr",qt,[...e[30]||(e[30]=[t("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"},"Aucun patient dans la corbeille",-1)])])):_("",!0)])]),a.patients.links&&a.patients.links.length>3?(d(),B(L,{key:0,links:a.patients.links,class:"p-4"},null,8,["links"])):_("",!0)],512),[[w,n.value==="patients"]]),b(t("div",Jt,[t("table",Kt,[e[33]||(e[33]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"R√©f√©rence"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Patient"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Prescripteur"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Montant"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Supprim√© le"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",Qt,[(d(!0),i(V,null,F(a.prescriptions.data,r=>{var v,D,M,z;return d(),i("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Wt,[t("span",Xt,s(r.reference),1)]),t("td",Yt,[t("div",Zt,s(((v=r.patient)==null?void 0:v.nom)||"N/A")+" "+s(((D=r.patient)==null?void 0:D.prenom)||""),1),t("div",te,s(((M=r.patient)==null?void 0:M.numero_dossier)||""),1)]),t("td",ee,s(((z=r.prescripteur)==null?void 0:z.nom)||"N/A"),1),t("td",re,[t("span",se,s(j(r.montant_total))+" Ar ",1)]),t("td",ae,s(A(r.deleted_at)),1),t("td",oe,[t("div",de,[t("button",{onClick:G=>T(r,"prescription"),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300"},"Restaurer",8,ne),t("button",{onClick:G=>R(r,"prescription"),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},"Supprimer",8,ie)])])])}),128)),a.prescriptions.data.length===0?(d(),i("tr",le,[...e[32]||(e[32]=[t("td",{colspan:"6",class:"px-6 py-12 text-center text-gray-500"},"Aucune prescription dans la corbeille",-1)])])):_("",!0)])]),a.prescriptions.links&&a.prescriptions.links.length>3?(d(),B(L,{key:0,links:a.prescriptions.links,class:"p-4"},null,8,["links"])):_("",!0)],512),[[w,n.value==="prescriptions"]])])]),y($,{show:c.value,onClose:e[6]||(e[6]=r=>c.value=!1)},{default:f(()=>[t("div",xe,[t("h2",pe," Restaurer "+s(l.value==="patient"?"ce patient":"cette prescription")+" ? ",1),e[34]||(e[34]=t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," √ätes-vous s√ªr de vouloir restaurer l'√©l√©ment s√©lectionn√© ? Il sera √† nouveau visible dans l'application. ",-1)),t("div",ce,[t("button",{onClick:e[5]||(e[5]=r=>c.value=!1),class:"px-4 py-2 border rounded-md text-gray-700 dark:text-gray-300"},"Annuler"),t("button",{onClick:E,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"},"Restaurer")])])]),_:1},8,["show"]),y($,{show:u.value,onClose:e[8]||(e[8]=r=>u.value=!1)},{default:f(()=>[t("div",ue,[t("h2",ge," Supprimer d√©finitivement "+s(l.value==="patient"?"ce patient":"cette prescription")+" ? ",1),e[35]||(e[35]=t("p",{class:"mt-1 text-sm text-red-600 dark:text-red-400"}," Cette action est irr√©versible. Toutes les donn√©es associ√©es seront supprim√©es d√©finitivement de la base de donn√©es. ",-1)),t("div",me,[t("button",{onClick:e[7]||(e[7]=r=>u.value=!1),class:"px-4 py-2 border rounded-md text-gray-700 dark:text-gray-300"},"Annuler"),t("button",{onClick:O,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"},"Supprimer d√©finitivement")])])]),_:1},8,["show"]),y($,{show:g.value,onClose:e[10]||(e[10]=r=>g.value=!1)},{default:f(()=>[t("div",ye,[t("h2",be," Vider la corbeille des "+s(l.value==="patient"?"patients":"prescriptions")+" ? ",1),e[36]||(e[36]=t("p",{class:"mt-1 text-sm text-red-600 dark:text-red-400"},[h(" Cette action est irr√©versible. "),t("strong",null,"Tous"),h(" les √©l√©ments de la corbeille seront supprim√©s d√©finitivement. ")],-1)),t("div",ke,[t("button",{onClick:e[9]||(e[9]=r=>g.value=!1),class:"px-4 py-2 border rounded-md text-gray-700 dark:text-gray-300"},"Annuler"),t("button",{onClick:I,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"},"Vider la corbeille compl√®te")])])]),_:1},8,["show"])])]),_:1})],64))}};export{Se as default};
