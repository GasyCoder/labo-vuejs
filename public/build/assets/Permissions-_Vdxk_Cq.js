import{r as m,w as D,c as l,a as P,u as J,h as q,b as G,d as e,e as M,o as d,F as f,f as j,n as c,t as i,v as I,g as B,i as w,j as A,k as L,l as V}from"./app-CiuF_e4D.js";import{_ as K}from"./AppLayout-BkGK7l-O.js";import"./debounce-BjP9TRjn.js";/* empty css            */import"./_commonjsHelpers-_d1bhYXs.js";import"./debounce-D0G5qrda.js";const U={class:"min-h-screen"},Q={class:"sticky top-0 z-30 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800"},W={class:"px-6 py-4"},X={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-4"},Y={class:"flex items-center gap-2 flex-wrap"},Z=["onClick"],ee={class:"capitalize"},te={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3"},re={class:"relative w-full sm:w-72"},se={class:"flex items-center gap-3 flex-wrap"},ae={class:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 rounded-full"},oe={class:"text-xs font-bold text-gray-700 dark:text-gray-300"},ne={key:0,class:"flex items-center gap-1.5 px-3 py-1.5 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800/50 rounded-full animate-pulse"},ie={class:"flex items-center gap-1.5"},le=["disabled"],de=["disabled"],ce={class:"px-6 py-6 pb-24 space-y-4 max-w-7xl mx-auto"},ge=["onClick"],ue={class:"flex items-center gap-4"},xe=["innerHTML"],ye={class:"text-sm font-bold text-gray-900 dark:text-white"},pe={class:"text-xs text-gray-500 dark:text-gray-400"},ke={class:"flex items-center gap-3"},ve=["onClick","title"],he={class:"border-t border-gray-100 dark:border-gray-800"},be={class:"divide-y divide-gray-50 dark:divide-gray-800/50"},me=["onClick"],fe={class:"flex items-center gap-3"},we={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Me={class:"hidden sm:inline-block px-1.5 py-0.5 text-[10px] font-mono font-medium text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-800 rounded"},je={key:0,class:"mt-0.5 text-xs text-gray-400 dark:text-gray-500 truncate"},Ce=["onClick"],_e={key:1,class:"flex flex-col items-center justify-center py-16 text-gray-400 dark:text-gray-500 bg-white dark:bg-gray-900 rounded-xl border border-dashed border-gray-300 dark:border-gray-700"},ze={class:"text-sm font-medium"},Oe={class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 transition-all duration-300"},Ee={__name:"Permissions",props:{roles:Array,selectedRole:String,permissionsMap:Object,rolePermissions:Object},setup(n){const g=n,v=m(""),a=m({...g.rolePermissions}),b=m({...g.rolePermissions}),h=m({});Object.keys(g.permissionsMap).forEach(s=>{h.value[s]=!0});const y=w(()=>JSON.stringify(a.value)!==JSON.stringify(b.value)),S=w(()=>Object.keys(a.value).length),C=w(()=>Object.values(a.value).filter(s=>s).length),_=w(()=>{if(!v.value)return g.permissionsMap;const s=v.value.toLowerCase(),t={};for(const[o,r]of Object.entries(g.permissionsMap)){const u={};for(const[x,k]of Object.entries(r))(x.toLowerCase().includes(s)||k.label.toLowerCase().includes(s)||k.module.toLowerCase().includes(s)||k.description&&k.description.toLowerCase().includes(s))&&(u[x]=k);Object.keys(u).length>0&&(t[o]=u)}return t}),E=s=>{y.value&&!confirm("Vous avez des modifications non enregistrées. Voulez-vous continuer sans sauvegarder ?")||V.get(route("admin.permissions"),{role:s},{preserveState:!0,preserveScroll:!0})};D(()=>g.rolePermissions,s=>{a.value={...s},b.value={...s}},{deep:!0});const z=s=>{a.value[s]=!a.value[s]},H=s=>{const t=Object.keys(g.permissionsMap[s]),o=t.every(r=>a.value[r]);t.forEach(r=>{a.value[r]=!o})},R=()=>{for(const s in a.value)a.value[s]=!0},$=()=>{for(const s in a.value)a.value[s]=!1},N=()=>{a.value={...b.value}},O=()=>{y.value&&V.put(route("admin.permissions.update"),{role:g.selectedRole,permissions:a.value},{preserveScroll:!0,onSuccess:()=>{b.value={...a.value}}})},T=(s,t)=>{switch(s){case"Prescriptions":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>';case"Analyses":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>';case"Patients":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" /></svg>';case"Prescripteurs":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';case"Laboratoire":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>';case"Administration":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>';case"Archives":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" /></svg>';default:return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>'}},F=s=>Object.keys(g.permissionsMap[s]||{}),p=s=>F(s).filter(o=>a.value[o]).length;return(s,t)=>(d(),l(f,null,[P(J(q),{title:"Gestion des Permissions"}),P(K,null,{default:G(()=>[e("div",U,[e("div",Q,[e("div",W,[e("div",X,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white tracking-tight"},"Permissions"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},"Configurez les droits d'accès pour chaque rôle")],-1)),e("div",Y,[(d(!0),l(f,null,j(n.roles,o=>(d(),l("button",{key:o.name,onClick:r=>E(o.name),class:c(["relative px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200",n.selectedRole===o.name?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/25":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"])},[e("span",ee,i(o.name),1)],10,Z))),128))])]),e("div",te,[e("div",re,[t[3]||(t[3]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-4 w-4 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),M(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>v.value=o),placeholder:"Rechercher une permission...",class:"w-full pl-10 pr-4 py-2 text-sm bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:text-white placeholder-gray-400 dark:placeholder-gray-500"},null,512),[[I,v.value]])]),e("div",se,[e("div",ae,[e("div",{class:c(["w-2 h-2 rounded-full",C.value>0?"bg-emerald-500":"bg-gray-400 dark:bg-gray-600"])},null,2),e("span",oe,i(C.value)+" / "+i(S.value),1),t[4]||(t[4]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"activées",-1))]),y.value?(d(),l("div",ne,[...t[5]||(t[5]=[e("div",{class:"w-1.5 h-1.5 rounded-full bg-amber-500"},null,-1),e("span",{class:"text-xs font-medium text-amber-700 dark:text-amber-400"},"Non enregistré",-1)])])):B("",!0),e("div",ie,[e("button",{onClick:R,class:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Tout activer"}," Tout "),e("button",{onClick:$,class:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Tout désactiver"}," Aucun "),e("button",{onClick:N,disabled:!y.value,class:c(["px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",y.value?"":"opacity-40 cursor-not-allowed"]),title:"Réinitialiser"}," Reset ",10,le),e("button",{onClick:O,disabled:!y.value,class:c(["px-4 py-1.5 text-xs font-bold text-white rounded-lg transition-all duration-200",y.value?"bg-indigo-600 hover:bg-indigo-700 shadow-lg shadow-indigo-500/25":"bg-gray-300 dark:bg-gray-700 cursor-not-allowed"])}," Enregistrer ",10,de)])])])])]),e("div",ce,[Object.keys(_.value).length>0?(d(!0),l(f,{key:0},j(_.value,(o,r)=>(d(),l("div",{key:r,class:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-sm transition-shadow duration-200 overflow-hidden"},[e("div",{class:"flex items-center justify-between px-6 py-4 cursor-pointer select-none group",onClick:u=>h.value[r]=!h.value[r]},[e("div",ue,[e("div",{class:c(["flex items-center justify-center w-10 h-10 rounded-xl transition-colors duration-200",p(r)===Object.keys(n.permissionsMap[r]||{}).length?"bg-indigo-100 dark:bg-indigo-900/30":"bg-gray-100 dark:bg-gray-800"]),innerHTML:T(r,p(r)===Object.keys(n.permissionsMap[r]||{}).length)},null,10,xe),e("div",null,[e("h3",ye,i(r),1),e("p",pe,i(Object.keys(n.permissionsMap[r]||{}).length)+" permission"+i(Object.keys(n.permissionsMap[r]||{}).length>1?"s":""),1)])]),e("div",ke,[e("span",{class:c(["text-xs font-bold px-2 py-0.5 rounded-full",p(r)===Object.keys(n.permissionsMap[r]||{}).length?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":p(r)>0?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400"])},i(p(r))+"/"+i(Object.keys(n.permissionsMap[r]||{}).length),3),e("button",{onClick:A(u=>H(r),["stop"]),class:c(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900",p(r)===Object.keys(n.permissionsMap[r]||{}).length?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"]),title:p(r)===Object.keys(n.permissionsMap[r]||{}).length?"Désactiver le module":"Activer le module"},[e("span",{class:c(["inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-200",p(r)===Object.keys(n.permissionsMap[r]||{}).length?"translate-x-[22px]":"translate-x-[2px]"])},null,2)],10,ve),(d(),l("svg",{class:c(["w-5 h-5 text-gray-400 dark:text-gray-500 transition-transform duration-200",h.value[r]?"rotate-180":""]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],8,ge),M(e("div",he,[e("div",be,[(d(!0),l(f,null,j(o,(u,x)=>(d(),l("div",{key:x,class:"flex items-center justify-between px-6 py-3.5 hover:bg-gray-50/80 dark:hover:bg-gray-800/40 transition-colors duration-150 group"},[e("div",{class:"flex-1 min-w-0 pr-4 cursor-pointer",onClick:k=>z(x)},[e("div",fe,[e("span",we,i(u.label),1),e("code",Me,i(x),1)]),u.description?(d(),l("p",je,i(u.description),1)):B("",!0)],8,me),e("button",{onClick:A(k=>z(x),["stop"]),class:c(["relative inline-flex h-5 w-9 flex-shrink-0 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900",a.value[x]?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"])},[e("span",{class:c(["inline-block h-3.5 w-3.5 transform rounded-full bg-white shadow-sm transition-transform duration-200",a.value[x]?"translate-x-[18px]":"translate-x-[3px]"])},null,2)],10,Ce)]))),128))])],512),[[L,h.value[r]]])]))),128)):(d(),l("div",_e,[t[7]||(t[7]=e("svg",{class:"w-12 h-12 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),e("p",ze,'Aucune permission trouvée pour "'+i(v.value)+'"',1),e("button",{onClick:t[1]||(t[1]=o=>v.value=""),class:"mt-2 text-xs text-indigo-500 dark:text-indigo-400 hover:underline"},"Effacer la recherche")]))]),M(e("div",Oe,[e("div",{class:"flex items-center gap-3 px-5 py-3 bg-gray-900 dark:bg-gray-100 rounded-2xl shadow-2xl shadow-gray-900/20"},[t[8]||(t[8]=e("div",{class:"w-2 h-2 rounded-full bg-amber-400 animate-pulse"},null,-1)),t[9]||(t[9]=e("span",{class:"text-sm font-medium text-white dark:text-gray-900 whitespace-nowrap"},"Modifications non enregistrées",-1)),e("button",{onClick:O,class:"px-4 py-1.5 min-w-[120px] text-sm font-bold text-gray-900 dark:text-white bg-white dark:bg-gray-900 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"}," Enregistrer ")])],512),[[L,y.value]])])]),_:1})],64))}};export{Ee as default};
