import{r as p,w as S,x as z,q as C,d as t,b as a,e as c,o,t as s,g as M,v as A,F as x,f as D,k as m,n as j,j as T,G as $}from"./app-DLV50I-f.js";import{_ as q,a as P}from"./SecondaryButton-DrIi44-i.js";/* empty css            */import"./_commonjsHelpers-_d1bhYXs.js";import"./debounce-D0G5qrda.js";const R={class:"bg-white dark:bg-gray-800"},L={key:0,class:"px-6 py-6"},H={class:"flex items-center justify-between mb-6"},Q={class:"text-2xl font-bold text-gray-900 dark:text-white"},U={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},E={class:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border border-gray-200 dark:border-gray-600"},O={class:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg border border-gray-200 dark:border-gray-600"},G={key:0,class:"flex justify-center p-8"},I={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},Y={class:"bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 p-4 rounded-lg border border-green-200 dark:border-green-700"},J={class:"text-2xl font-bold text-green-800 dark:text-green-300"},K={class:"bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-4 rounded-lg border border-blue-200 dark:border-blue-700"},W={class:"text-2xl font-bold text-blue-800 dark:text-blue-300"},X={class:"bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 p-4 rounded-lg border border-purple-200 dark:border-purple-700"},Z={class:"text-2xl font-bold text-purple-800 dark:text-purple-300"},tt={class:"bg-gradient-to-r from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-700"},et={class:"text-sm font-medium text-yellow-600 dark:text-yellow-400"},rt={class:"text-2xl font-bold text-yellow-800 dark:text-yellow-300"},st={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},ot={class:"overflow-x-auto"},at={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},nt={class:"bg-gray-50 dark:bg-gray-700/50"},dt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},it={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},lt=["onClick"],gt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white flex items-center"},ut={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},xt={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},mt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100 font-medium"},pt={class:"px-6 py-4 whitespace-nowrap text-sm"},ct={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},yt={key:1,class:"flex flex-col"},bt={class:"text-[10px] text-gray-500 mt-1"},kt={key:0,class:"text-[10px] font-normal text-red-500 italic"},ft={key:0,class:"bg-gray-50/50 dark:bg-gray-800/50"},vt={colspan:"5",class:"px-10 py-4"},ht={class:"bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},wt={class:"min-w-full divide-y divide-gray-100 dark:divide-gray-700"},_t={class:"divide-y divide-gray-100 dark:divide-gray-700"},Ct={class:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300"},Mt={class:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400"},At={class:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400"},Dt={class:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300"},jt={class:"px-4 py-2 text-sm font-medium text-green-600 dark:text-green-400"},Bt={key:1},Vt={key:0,class:"mt-6 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 p-6 rounded-lg border border-green-200 dark:border-green-700"},Ft={class:"flex items-center justify-between"},Nt={class:"text-sm text-gray-600 dark:text-gray-400"},St={class:"text-right"},zt={class:"text-3xl font-bold text-green-600 dark:text-green-400"},Tt={class:"text-sm text-gray-600 dark:text-gray-400"},$t={class:"bg-gray-50 dark:bg-gray-700/50 px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3"},qt=["href"],Ut={__name:"ModalCommissionPrescripteur",props:{show:Boolean,prescripteur:Object},emits:["close"],setup(l,{emit:B}){const y=l,V=B,v=p(!1),_=new Date,b=p(`${_.getFullYear()}-01-01`),k=p(_.toISOString().split("T")[0]),d=p({data:[],total_commission:0,total_prescriptions:0,montant_total_analyses:0,montant_total_paye:0,commission_moyenne:0}),u=p({}),i=n=>n==null?"0":Number(n).toLocaleString("fr-FR"),F=n=>{const e=new Date;e.setMonth(n-1);const r=e.toLocaleString("fr-FR",{month:"long"});return r.charAt(0).toUpperCase()+r.slice(1)},h=async(n=!0)=>{if(y.prescripteur){n&&(v.value=!0),u.value={};try{const e=await $.get(route("secretaire.prescripteurs.commissions.api",y.prescripteur.id),{params:{dateDebut:b.value,dateFin:k.value}});d.value=e.data}catch(e){console.error("Erreur lors du chargement des commissions",e)}finally{n&&(v.value=!1)}}},N=n=>{u.value[n]=!u.value[n]};S(()=>y.show,n=>{n&&y.prescripteur?h():u.value={}});const w=()=>{V("close")};return(n,e)=>(o(),z(P,{show:l.show,"max-width":"4xl",onClose:w},{default:C(()=>[t("div",R,[l.prescripteur?(o(),a("div",L,[t("div",H,[t("h2",Q," Commissions de "+s(l.prescripteur.nom_complet),1),t("button",{onClick:w,class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 rounded-lg p-2 hover:bg-gray-100 dark:hover:bg-gray-700"},[...e[4]||(e[4]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",U,[t("div",E,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Date de début",-1)),M(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=r=>b.value=r),onChange:e[1]||(e[1]=r=>h(!0)),class:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 dark:focus:ring-blue-400"},null,544),[[A,b.value]])]),t("div",O,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Date de fin",-1)),M(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=r=>k.value=r),onChange:e[3]||(e[3]=r=>h(!0)),class:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 dark:focus:ring-blue-400"},null,544),[[A,k.value]])])]),v.value?(o(),a("div",G,[...e[7]||(e[7]=[t("svg",{class:"animate-spin h-8 w-8 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):(o(),a(x,{key:1},[t("div",I,[t("div",Y,[e[8]||(e[8]=t("div",{class:"text-sm font-medium text-green-600 dark:text-green-400"},"Prescriptions",-1)),t("div",J,s(i(d.value.total_prescriptions)),1)]),t("div",K,[e[9]||(e[9]=t("div",{class:"text-sm font-medium text-blue-600 dark:text-blue-400"},"Montant analyses",-1)),t("div",W,s(i(d.value.montant_total_analyses))+" Ar",1)]),t("div",X,[e[10]||(e[10]=t("div",{class:"text-sm font-medium text-purple-600 dark:text-purple-400"},"Total payé",-1)),t("div",Z,s(i(d.value.montant_total_paye))+" Ar",1)]),t("div",tt,[t("div",et,"Commission totale ("+s(l.prescripteur.commission_pourcentage)+"%)",1),t("div",rt,s(i(d.value.total_commission))+" Ar",1)])]),t("div",st,[e[22]||(e[22]=t("div",{class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Répartition par mois")],-1)),t("div",ot,[t("table",at,[t("thead",nt,[t("tr",null,[e[11]||(e[11]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Mois / Année",-1)),e[12]||(e[12]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Prescriptions",-1)),e[13]||(e[13]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Montant analyses (Brut)",-1)),e[14]||(e[14]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Status Quota",-1)),t("th",dt,"Commission ("+s(l.prescripteur.commission_pourcentage)+"%)",1)])]),t("tbody",it,[d.value.data&&d.value.data.length>0?(o(!0),a(x,{key:0},D(d.value.data,(r,f)=>(o(),a(x,{key:f},[t("tr",{class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer",onClick:g=>N(f)},[t("td",gt,[(o(),a("svg",{class:j(["h-4 w-4 mr-2 text-gray-500 transition-transform",{"rotate-90":u.value[f]}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...e[15]||(e[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)])],2)),m(" "+s(F(r.mois))+" "+s(r.annee),1)]),t("td",ut,[t("span",xt,s(r.nombre_prescriptions),1)]),t("td",mt,s(i(r.montant_analyses))+" Ar ",1),t("td",pt,[r.quota_atteint?(o(),a("span",ct,[...e[16]||(e[16]=[t("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),m(" Quota atteint ",-1)])])):(o(),a("div",yt,[e[17]||(e[17]=t("span",{class:"inline-flex items-center px-2.5 py-0.5 w-max rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}," Sous quota ",-1)),t("span",bt,s(i(r.montant_analyses))+" / "+s(i(r.quota_montant)),1)]))]),t("td",{class:j(["px-6 py-4 whitespace-nowrap text-sm font-semibold",r.commission>0?"text-green-600 dark:text-green-400":"text-gray-400"])},[r.commission>0?(o(),a(x,{key:0},[m(s(i(r.commission))+" Ar ",1)],64)):(o(),a(x,{key:1},[e[18]||(e[18]=m(" 0 Ar ",-1)),r.quota_atteint?c("",!0):(o(),a("div",kt,"Quota non atteint"))],64))],2)],8,lt),u.value[f]&&r.prescriptions&&r.prescriptions.length?(o(),a("tr",ft,[t("td",vt,[t("div",ht,[e[20]||(e[20]=t("div",{class:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-xs font-semibold text-gray-600 dark:text-gray-300"}," Détails des prescriptions ",-1)),t("table",wt,[e[19]||(e[19]=t("thead",{class:"bg-gray-50 dark:bg-gray-800/70"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400"},"Patient"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400"},"N° Dossier"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400"},"Date"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400"},"Montant analyses"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400"},"Commission")])],-1)),t("tbody",_t,[(o(!0),a(x,null,D(r.prescriptions,g=>(o(),a("tr",{key:g.id},[t("td",Ct,s(g.patient_nom_complet),1),t("td",Mt,s(g.patient_numero_dossier),1),t("td",At,s(g.date),1),t("td",Dt,s(i(g.montant_analyses))+" Ar",1),t("td",jt,s(i(g.commission))+" Ar",1)]))),128))])])])])])):c("",!0)],64))),128)):(o(),a("tr",Bt,[...e[21]||(e[21]=[t("td",{colspan:"5",class:"px-6 py-12 text-center"},[t("div",{class:"flex flex-col items-center"},[t("div",{class:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4"},[t("svg",{class:"w-8 h-8 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])]),t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-1"},"Aucune commission"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," Aucune commission trouvée pour la période sélectionnée ")])],-1)])]))])])])]),d.value.total_commission>0?(o(),a("div",Vt,[t("div",Ft,[t("div",null,[e[23]||(e[23]=t("h4",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Commission totale à percevoir",-1)),t("p",Nt," Sur "+s(d.value.total_prescriptions)+" prescription(s) payée(s) ",1)]),t("div",St,[t("div",zt,s(i(d.value.total_commission))+" Ar ",1),t("div",Tt," Taux : "+s(l.prescripteur.commission_pourcentage)+"% du prix d'analyse brute ",1)])])])):c("",!0)],64))])):c("",!0),t("div",$t,[T(q,{onClick:w},{default:C(()=>[...e[24]||(e[24]=[m(" Fermer ",-1)])]),_:1}),l.prescripteur&&d.value.total_commission>0?(o(),a("a",{key:0,href:n.route("secretaire.prescripteurs.commissions.pdf",{prescripteur:l.prescripteur.id,dateDebut:b.value,dateFin:k.value}),target:"_blank",class:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"},[...e[25]||(e[25]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),m(" Télécharger PDF ",-1)])],8,qt)):c("",!0)])])]),_:1},8,["show"]))}};export{Ut as default};
