import{r as v,w as A,c as n,a as L,b as J,h as G,d as I,e,f as j,o as i,F as f,p as C,n as x,t as d,l as K,j as U,q as w,i as S,m as E,z as V}from"./app-CfKzR4Wd.js";import{_ as Q}from"./AppLayout-DYFev4JA.js";import{d as W}from"./debounce-BjP9TRjn.js";/* empty css            */import"./_commonjsHelpers-_d1bhYXs.js";import"./debounce-D0G5qrda.js";const X={class:"px-4 sm:px-6 lg:px-8 pt-6 pb-4"},Y={class:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4 mb-5"},Z={class:"flex items-center gap-2 flex-wrap"},ee=["onClick"],te={class:"capitalize"},re={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-3"},se={class:"relative w-full sm:w-72"},oe={class:"flex items-center gap-3 flex-wrap"},ae={class:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-700 rounded-full"},ne={class:"text-xs font-bold text-gray-700 dark:text-gray-300"},ie={key:0,class:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800/50 rounded-full"},le={key:1,class:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800/50 rounded-full transition-opacity"},de={class:"px-4 sm:px-6 lg:px-8 py-6 pb-24 space-y-4"},ce=["onClick"],ge={class:"flex items-center gap-4"},ue=["innerHTML"],xe={class:"text-sm font-bold text-gray-900 dark:text-white"},pe={class:"text-xs text-gray-500 dark:text-gray-400"},ye={class:"flex items-center gap-3"},ke=["onClick","title"],ve={class:"border-t border-gray-100 dark:border-gray-800 bg-gray-50/30 dark:bg-gray-900/50 p-6"},be={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"},he=["onClick"],me={class:"flex items-start justify-between mb-3"},fe={class:"flex flex-col gap-1 pr-4"},we={class:"text-sm font-semibold text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors"},Me={class:"self-start px-1.5 py-0.5 text-[10px] font-mono font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-900 rounded border border-gray-200 dark:border-gray-700"},je=["onClick"],Ce={key:0,class:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed"},_e={key:1,class:"text-xs text-gray-400 dark:text-gray-500 italic"},Be={key:1,class:"flex flex-col items-center justify-center py-16 text-gray-400 dark:text-gray-500 bg-white dark:bg-gray-900 rounded-xl border border-dashed border-gray-300 dark:border-gray-700"},ze={class:"text-sm font-medium"},Oe={class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 transition-all duration-300"},Pe={class:"flex items-center gap-3 px-5 py-3 bg-gray-900 dark:bg-gray-100 rounded-2xl shadow-2xl shadow-gray-900/20"},$e={__name:"Permissions",props:{roles:Array,selectedRole:String,permissionsMap:Object,rolePermissions:Object},setup(l){const c=l,k=v(""),o=v({...c.rolePermissions}),M=v({...c.rolePermissions}),h=v(!1),m=v(!1);let _=null;const b=v({});Object.keys(c.permissionsMap).forEach(s=>{b.value[s]=!0});const B=w(()=>JSON.stringify(o.value)!==JSON.stringify(M.value)),T=w(()=>Object.keys(o.value).length),z=w(()=>Object.values(o.value).filter(s=>s).length),O=w(()=>{if(!k.value)return c.permissionsMap;const s=k.value.toLowerCase(),t={};for(const[a,r]of Object.entries(c.permissionsMap)){const g={};for(const[u,y]of Object.entries(r))(u.toLowerCase().includes(s)||y.label.toLowerCase().includes(s)||y.module.toLowerCase().includes(s)||y.description&&y.description.toLowerCase().includes(s))&&(g[u]=y);Object.keys(g).length>0&&(t[a]=g)}return t}),H=W(()=>{B.value&&(h.value=!0,m.value=!1,V.put(route("admin.permissions.update"),{role:c.selectedRole,permissions:o.value},{preserveScroll:!0,onSuccess:()=>{M.value={...o.value},h.value=!1,m.value=!0,clearTimeout(_),_=setTimeout(()=>{m.value=!1},2e3)},onError:()=>{h.value=!1}}))},500);A(o,()=>{H()},{deep:!0});const $=s=>{V.get(route("admin.permissions"),{role:s},{preserveState:!0,preserveScroll:!0})};A(()=>c.rolePermissions,s=>{o.value={...s},M.value={...s}},{deep:!0});const P=s=>{o.value[s]=!o.value[s]},N=s=>{const t=Object.keys(c.permissionsMap[s]),a=t.every(r=>o.value[r]);t.forEach(r=>{o.value[r]=!a})},R=()=>{for(const s in o.value)o.value[s]=!0},F=()=>{for(const s in o.value)o.value[s]=!1},D=(s,t)=>{switch(s){case"Prescriptions":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>';case"Analyses":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>';case"Patients":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" /></svg>';case"Prescripteurs":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';case"Laboratoire":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>';case"Administration":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>';case"Archives":return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" /></svg>';default:return'<svg class="w-5 h-5 '+(t?"text-primary-500":"text-gray-400 dark:text-gray-500")+'" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>'}},q=s=>Object.keys(c.permissionsMap[s]||{}),p=s=>q(s).filter(a=>o.value[a]).length;return(s,t)=>(i(),n(f,null,[L(J(G),{title:"Gestion des Permissions"}),L(Q,null,{default:I(()=>[e("div",null,[e("div",X,[e("div",Y,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white tracking-tight"},"Permissions"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Configurez les droits d'accès pour chaque rôle")],-1)),e("div",Z,[(i(!0),n(f,null,C(l.roles,a=>(i(),n("button",{key:a.name,onClick:r=>$(a.name),class:x(["relative px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200",l.selectedRole===a.name?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/25":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"])},[e("span",te,d(a.name),1)],10,ee))),128))])]),e("div",re,[e("div",se,[t[4]||(t[4]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-4 w-4 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),j(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>k.value=a),placeholder:"Rechercher une permission...",class:"w-full pl-10 pr-4 py-2 text-sm bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:text-white placeholder-gray-400 dark:placeholder-gray-500"},null,512),[[K,k.value]])]),e("div",oe,[e("div",ae,[e("div",{class:x(["w-2 h-2 rounded-full",z.value>0?"bg-emerald-500":"bg-gray-400 dark:bg-gray-600"])},null,2),e("span",ne,d(z.value)+" / "+d(T.value),1),t[5]||(t[5]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"activées",-1))]),h.value?(i(),n("div",ie,[...t[6]||(t[6]=[e("svg",{class:"w-3.5 h-3.5 text-blue-500 animate-spin",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),e("span",{class:"text-xs font-medium text-blue-700 dark:text-blue-400"},"Enregistrement...",-1)])])):m.value?(i(),n("div",le,[...t[7]||(t[7]=[e("svg",{class:"w-3.5 h-3.5 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("span",{class:"text-xs font-medium text-emerald-700 dark:text-emerald-400"},"Enregistré",-1)])])):U("",!0),e("div",{class:"flex items-center gap-1.5"},[e("button",{onClick:R,class:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",title:"Tout activer"}," Tout "),e("button",{onClick:F,class:"px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",title:"Tout désactiver"}," Aucun ")])])])]),e("div",de,[Object.keys(O.value).length>0?(i(!0),n(f,{key:0},C(O.value,(a,r)=>(i(),n("div",{key:r,class:"bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 shadow-sm transition-shadow duration-200 overflow-hidden"},[e("div",{class:"flex items-center justify-between px-6 py-4 cursor-pointer select-none group",onClick:g=>b.value[r]=!b.value[r]},[e("div",ge,[e("div",{class:x(["flex items-center justify-center w-10 h-10 rounded-xl transition-colors duration-200",p(r)===Object.keys(l.permissionsMap[r]||{}).length?"bg-indigo-100 dark:bg-indigo-900/30":"bg-gray-100 dark:bg-gray-800"]),innerHTML:D(r,p(r)===Object.keys(l.permissionsMap[r]||{}).length)},null,10,ue),e("div",null,[e("h3",xe,d(r),1),e("p",pe,d(Object.keys(l.permissionsMap[r]||{}).length)+" permission"+d(Object.keys(l.permissionsMap[r]||{}).length>1?"s":""),1)])]),e("div",ye,[e("span",{class:x(["text-xs font-bold px-2 py-0.5 rounded-full",p(r)===Object.keys(l.permissionsMap[r]||{}).length?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":p(r)>0?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400"])},d(p(r))+"/"+d(Object.keys(l.permissionsMap[r]||{}).length),3),e("button",{onClick:S(g=>N(r),["stop"]),class:x(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900",p(r)===Object.keys(l.permissionsMap[r]||{}).length?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"]),title:p(r)===Object.keys(l.permissionsMap[r]||{}).length?"Désactiver le module":"Activer le module"},[e("span",{class:x(["inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-200",p(r)===Object.keys(l.permissionsMap[r]||{}).length?"translate-x-[22px]":"translate-x-[2px]"])},null,2)],10,ke),(i(),n("svg",{class:x(["w-5 h-5 text-gray-400 dark:text-gray-500 transition-transform duration-200",b.value[r]?"rotate-180":""]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],8,ce),j(e("div",ve,[e("div",be,[(i(!0),n(f,null,C(a,(g,u)=>(i(),n("div",{key:u,onClick:y=>P(u),class:"flex flex-col justify-between p-4 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md hover:border-indigo-300 dark:hover:border-indigo-500/50 transition-all duration-200 cursor-pointer group"},[e("div",me,[e("div",fe,[e("span",we,d(g.label),1),e("code",Me,d(u),1)]),e("button",{onClick:S(y=>P(u),["stop"]),class:x(["relative inline-flex h-6 w-11 flex-shrink-0 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900",o.value[u]?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600"])},[e("span",{class:x(["inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-200",o.value[u]?"translate-x-[22px]":"translate-x-[2px]"])},null,2)],10,je)]),g.description?(i(),n("p",Ce,d(g.description),1)):(i(),n("p",_e,"Aucune description disponible."))],8,he))),128))])],512),[[E,b.value[r]]])]))),128)):(i(),n("div",Be,[t[9]||(t[9]=e("svg",{class:"w-12 h-12 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),e("p",ze,'Aucune permission trouvée pour "'+d(k.value)+'"',1),e("button",{onClick:t[1]||(t[1]=a=>k.value=""),class:"mt-2 text-xs text-indigo-500 dark:text-indigo-400 hover:underline"},"Effacer la recherche")]))]),j(e("div",Oe,[e("div",Pe,[t[10]||(t[10]=e("div",{class:"w-2 h-2 rounded-full bg-amber-400 animate-pulse"},null,-1)),t[11]||(t[11]=e("span",{class:"text-sm font-medium text-white dark:text-gray-900 whitespace-nowrap"},"Modifications non enregistrées",-1)),e("button",{onClick:t[2]||(t[2]=(...a)=>s.savePermissions&&s.savePermissions(...a)),class:"px-4 py-1.5 min-w-[120px] text-sm font-bold text-gray-900 dark:text-white bg-white dark:bg-gray-900 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"}," Enregistrer ")])],512),[[E,B.value]])])]),_:1})],64))}};export{$e as default};
